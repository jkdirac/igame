/* Begin CVS Header
 $Source: /fs/turing/cvs/copasi_dev/copasi/odepack++/CInternalSolver.h,v $
 $Revision: 1.7 $
 $Name: Build-31 $
 $Author: shoops $
 $Date: 2009/01/07 19:01:06 $
 End CVS Header */

// Copyright (C) 2008 by Pedro Mendes, Virginia Tech Intellectual
// Properties, Inc., EML Research, gGmbH, University of Heidelberg,
// and The University of Manchester.
// All rights reserved.

// Copyright (C) 2001 - 2007 by Pedro Mendes, Virginia Tech Intellectual
// Properties, Inc. and EML Research, gGmbH.
// All rights reserved.
//
// This C++ code is based on an f2c conversion of the Fortran
// library ODEPACK available at: http://www.netlib.org/odepack/

#ifndef ODEPACK_CInternalSolver
#define ODEPACK_CInternalSolver

#include "odepack++/common.h"
#include "odepack++/Cxerrwd.h"

class CInternalSolver
  {
  private:

  protected:
    CInternalSolver():
        mxerrwd(true),
        mpdls001_(NULL),
        mpdlsa01_(NULL),
        mpdlsr01_(NULL)
    {}

  public:
    ~CInternalSolver()
    {
      if (mpdls001_ != NULL) {delete mpdls001_; mpdls001_ = NULL;}
      if (mpdlsa01_ != NULL) {delete mpdlsa01_; mpdlsa01_ = NULL;}
      if (mpdlsr01_ != NULL) {delete mpdlsr01_; mpdlsr01_ = NULL;}
    }

    void setOstream(std::ostream & os)
    {mxerrwd.setOstream(os);}

    void enablePrint(const bool & print = true)
    {mxerrwd.enablePrint(print);}

  protected:
    C_INT dintdy_(double *t, const C_INT *k, double *yh,
                  C_INT *nyh, double *dky, C_INT *iflag);

    C_INT dprja_(C_INT *neq, double *y, double *yh,
                 C_INT *nyh, double *ewt, double *ftem, double *savf,
                 double *wm, C_INT *iwm, evalF f, evalJ jac);

    C_INT drchek_(const C_INT * job, evalG g, C_INT *neq, double *
                  y, double *yh, C_INT *nyh, double *g0, double *g1,
                  double *gx, C_INT *jroot, C_INT *irt);

    C_INT droots_(C_INT *ng, double *hmin, C_INT *jflag,
                  double *x0, double *x1, double *g0, double *g1,
                  double *gx, double *x, C_INT *jroot);

    C_INT dsolsy_(double *wm, C_INT *iwm, double *x,
                  double *tem);

    C_INT dstoda_(C_INT *neq, double *y, double *yh,
                  C_INT *nyh, double *yh1, double *ewt, double *savf,
                  double *acor, double *wm, C_INT *iwm, evalF f, evalJ jac,
                  PJAC * pjac, SLVS * slvs);

  protected:
    Cxerrwd mxerrwd;
    dls001 * mpdls001_;
    dlsa01 * mpdlsa01_;
    dlsr01 * mpdlsr01_;
  };

#endif // ODEPACK_CInternalSolver
